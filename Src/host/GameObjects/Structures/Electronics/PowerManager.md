
# ElecticalDevice

Электронное устройство

edReqPower - сколько требует энергии для работы. Только для конечных источников где edIsNode == false

edIsNode - является ли неконечным узлом в сети. Если не узел (лампа, консоль) то флаг false
edConnected - список подключенных устройств к этому устройству. Существует только если edIsNode == true
edOwner - владелец этого устройства

edNodeReqPower - сколько энергии требует этот узел. Только если edIsNode == true

edIsEnabled - включен ли данный источник. Управляется пользователем
edIsUsePower - использует ли источник энергию. Например при нехватке энергии этот флаг станет false

	onPowerLess() - событие, вызываемое при потере электричества (нехватка)
	onPowerRestore() - событие, вызываемое при восстановлении электричества (включение или подача энергии)

addConnection(ElecticalDevice obj) - подключает новое устройство
removeConnection(ElecticalDevice obj) - убирает устройство из линии подключения

getNodeReqPower() - рекурсивный вызов. Для неузловых источников проверяет edIsEnabled. Если истина то возвращает edReqPower или 0

## Алгоритм проверки электричества через генератор
Главный цикл:
	Проход по элементам массива с вызовом getNodeReqPower()

------------- псевдокод ------------
	
	По циклу всех подключенных источников
		если не хватает энергии
			выключаем подачу электричества на всех узлах
				при выключении вызываем onChangePowerState (будет выключаться свет)
		или (если хватает)
			//вызываем syncPowerState (рекурсивный)
				если источник не запитан запитываем и вызываем onChangePowerState
				
onChangePowerState
	если узлы включены то подаем электричество
------------------------------
Новый алгоритм обрабатывает каждый источник в потоке

Цикл энергии определяет кого запитывать

---------

Последняя проблема - свитчинг двух одинаковых источников 